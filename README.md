<div align="center">
  <h1>🚀 Auto-Yuque</h1>
  <p>智能化语雀自动化工具 - 让知识管理更高效</p>
  
  [![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/downloads/)
  [![Selenium](https://img.shields.io/badge/Selenium-4.x-green.svg)](https://selenium-python.readthedocs.io/)
  [![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
  [![GitHub stars](https://img.shields.io/github/stars/poboll/auto-yuque.svg)](https://github.com/poboll/auto-yuque/stargazers)
  [![GitHub issues](https://img.shields.io/github/issues/poboll/auto-yuque.svg)](https://github.com/poboll/auto-yuque/issues)
</div>

## 📖 项目简介

Auto-Yuque 是一个基于 Python + Selenium 的语雀平台自动化工具，提供**命令行**和**图形界面**两种使用方式，旨在帮助用户高效管理语雀知识库，自动化执行各种操作任务。无论您是开发者还是普通用户，都能轻松上手使用。

### ✨ 核心特性

#### 🎯 四大核心功能模块

**📝 智能小记管理**
- 自动创建测试小记，验证发布功能
- 智能定位和删除指定小记
- 完整的小记生命周期管理和状态验证
- 支持富文本内容的自动化编辑

**🌟 社区互动探索**
- 自动浏览"逛逛"页面，抓取热门文章标题
- 智能点赞优质内容，提升社区参与度
- 深度抓取文章详细内容（作者、正文、互动数据）
- 集成AI评论生成，自动生成高质量个性化评论

**📚 知识库文档管理**
- 自动进入用户的知识库空间
- 智能创建新文档，支持自定义标题和内容
- 验证文档创建状态，确保操作成功
- 支持富文本编辑和格式化内容

**👥 用户发现与关注**
- 从"逛逛"页面智能发现优质创作者
- 自动访问用户主页，分析用户价值
- 执行关注操作，扩展人脉网络
- 跟踪关注状态，避免重复操作

#### 🛠️ 技术特性

- 🔐 **智能登录管理** - Cookie 持久化，免重复登录验证
- 🎨 **双界面支持** - 现代化GUI界面 + 传统命令行界面
- 🤖 **AI 智能评论** - 集成先进AI模型，生成真实自然的评论
- 📊 **数据管理** - 完整的CSV数据导出和汇总分析
- 🔄 **多线程执行** - 界面响应流畅，操作不卡顿
- 📸 **操作记录** - 自动截图保存，便于问题排查
- ⚡ **智能重试** - 网络异常自动重试，提高成功率

## 🏗️ 项目架构

```
auto-yuque/
├── 🎯 核心程序
│   ├── main.py                 # 命令行主程序，包含4大核心功能
│   ├── gui.py                  # 现代化GUI界面程序
│   ├── simple_gui.py           # 简化命令行界面（无需tkinter）
│   ├── start_gui.py            # 智能启动器，自动选择最佳界面
│   └── comment_generator.py    # AI 评论生成模块
├── 📁 配置与数据
│   ├── config.json            # 配置文件（ChromeDriver路径等）
│   ├── cookie.pkl             # 登录Cookie存储文件
│   ├── requirements.txt       # Python依赖包列表
│   └── *.csv                  # 数据文件（文章、评论、汇总等）
├── 📂 资源目录
│   ├── screenshots/           # 操作截图存储目录
│   └── driver/                # ChromeDriver存储目录
├── 📖 文档说明
│   ├── README.md              # 项目主文档
│   ├── GUI_README.md          # GUI界面详细使用说明
│   ├── PROJECT_GUIDE.md       # 项目开发指南
│   └── LICENSE                # 开源许可证
└── 🚀 构建发布
    └── .github/workflows/     # GitHub Actions自动构建
```

## 🚀 快速开始

### 环境要求

- **操作系统**: Windows 10/11, macOS 10.14+, Ubuntu 18.04+
- **Python**: 3.7 或更高版本
- **浏览器**: Chrome 浏览器（最新版本）
- **网络**: 稳定的互联网连接

### 依赖安装

#### 方法一：使用虚拟环境（推荐）
```bash
# 创建虚拟环境
python3 -m venv yuque_env

# 激活虚拟环境
# macOS/Linux:
source yuque_env/bin/activate
# Windows:
# yuque_env\Scripts\activate

# 安装依赖
pip install -r requirements.txt
```

#### 方法二：直接安装
```bash
# macOS Homebrew Python用户
pip install -r requirements.txt --break-system-packages

# 或者使用用户安装
pip install -r requirements.txt --user
```

#### 安装图形界面支持（如果需要）
```bash
# macOS
brew install python-tk

# Ubuntu/Debian
sudo apt-get install python3-tk

# CentOS/RHEL
sudo yum install tkinter
```

### 运行程序

#### 🎯 智能启动器（推荐）
```bash
python start_gui.py
```
启动器会自动检测您的环境并选择最合适的界面版本。

#### 🖥️ 图形界面版本
```bash
python gui.py
```
提供完整的图形用户界面，支持所有功能的可视化操作。

#### 📟 简化命令行界面
```bash
python simple_gui.py
```
文本菜单界面，无需图形界面支持，适合服务器环境。

#### ⌨️ 传统命令行版本
```bash
python main.py
```
原始命令行界面，适合脚本化和自动化场景。

### ChromeDriver 配置

1. **下载 ChromeDriver**
   - 访问 [ChromeDriver官网](https://chromedriver.chromium.org/)
   - 下载与您的Chrome浏览器版本匹配的ChromeDriver

2. **GUI用户**: 在界面中点击"浏览"按钮选择ChromeDriver路径
3. **命令行用户**: 将ChromeDriver路径添加到系统PATH，或放置在项目根目录

### AI 评论配置

在 `config.json` 中配置AI服务：

```json
{
  "ai_comment": {
    "enabled": true,
    "api_key": "your_api_key_here",
    "base_url": "https://api.siliconflow.cn/v1",
    "model": "deepseek-ai/DeepSeek-V2.5",
    "max_tokens": 150,
    "temperature": 0.7
  }
}
```

**支持的AI服务**:
- SiliconFlow API（推荐，免费额度）
- OpenAI GPT系列
- 其他兼容OpenAI格式的API服务

## 🖥️ GUI界面详解

### 界面概述

本项目提供了直观的图形用户界面，让用户无需命令行操作即可享受所有自动化功能。界面采用现代化设计，支持实时日志显示和状态监控。

### 界面布局

#### 📋 配置设置区域
- **ChromeDriver路径设置**: 可视化选择ChromeDriver文件
- **浏览按钮**: 打开系统文件选择对话框
- **路径验证**: 自动验证选择的文件有效性

#### 🔐 登录状态区域
- **状态指示器**: 实时显示登录状态（未登录/已登录）
- **初始化按钮**: 一键启动浏览器并执行登录流程
- **自动Cookie管理**: 智能保存和恢复登录状态

#### 🎮 功能操作区域
四个核心功能按钮，对应main.py中的主要功能：

1. **📝 智能小记** - 执行小记创建和删除测试
2. **🌟 社区探索** - 抓取逛逛页面并智能互动
3. **📚 知识管理** - 自动化知识库文档操作
4. **👥 用户关注** - 发现并关注优质创作者

#### 📊 数据管理区域
- **CSV汇总按钮**: 一键合并所有生成的数据文件
- **数据导出**: 生成结构化的分析报告

#### 📝 实时日志区域
- **多线程日志**: 实时显示所有操作进度
- **时间戳记录**: 精确的操作时间追踪
- **自动滚动**: 新日志自动滚动到可视区域
- **颜色编码**: 不同类型的消息使用不同颜色

#### 🔧 底部控制区域
- **清空日志**: 一键清理日志显示区域
- **安全退出**: 智能关闭浏览器并退出程序

### 使用流程

#### 第一步：环境配置
1. 启动GUI程序：`python gui.py`
2. 点击"浏览"按钮选择ChromeDriver文件
3. 程序自动验证并保存配置

#### 第二步：登录认证
1. 点击"初始化并登录"按钮
2. 程序自动打开Chrome浏览器
3. 首次使用需手动扫码登录
4. 登录成功后Cookie自动保存
5. 状态显示更新为"已登录"

#### 第三步：功能执行
登录成功后，所有功能按钮自动启用：

- **智能小记测试**: 完整的小记生命周期测试
- **社区探索测试**: 深度挖掘逛逛页面内容
- **知识管理测试**: 自动化文档创建和管理
- **用户关注测试**: 智能发现和关注优质用户
- **数据汇总处理**: 生成综合分析报告

### 技术特性

#### 🔄 多线程架构
- 所有自动化操作在后台线程执行
- 界面始终保持响应，无卡顿现象
- 实时进度反馈和状态更新

#### 🛡️ 错误处理
- 智能异常捕获和处理
- 详细的错误日志和解决建议
- 自动重试机制和容错设计

#### 💾 状态管理
- 自动保存用户配置和登录状态
- 智能恢复上次会话
- 配置文件版本兼容性

#### 🎨 用户体验
- 响应式窗口大小，适配不同分辨率
- 现代化UI设计，符合用户习惯
- 智能按钮状态管理
- 实时操作反馈

## 🎯 功能详解

### 📝 智能小记管理 (`test_create_and_delete_note`)

**功能概述**: 完整的小记生命周期自动化测试

**核心流程**:
1. **智能编辑器定位** - 使用多重选择器策略定位编辑器
2. **内容创建** - 自动生成带时间戳的唯一测试内容
3. **发布验证** - 智能检测发布按钮并执行发布操作
4. **状态确认** - 刷新页面验证小记创建成功
5. **精准删除** - 定位目标小记并执行删除操作
6. **完整性检查** - 验证删除操作的成功执行

**技术特点**:
- 🎯 多重选择器容错机制，适应页面变化
- 🔄 自动重试和状态验证
- 📸 关键步骤自动截图记录
- ⚡ ActionChains确保交互稳定性

### 🌟 社区互动探索 (`test_explore_page`)

**功能概述**: 深度挖掘"逛逛"页面，实现智能社区互动

**核心流程**:
1. **页面导航** - 自动进入语雀"逛逛"社区页面
2. **标题抓取** - 批量提取热门文章标题和链接
3. **智能点赞** - 为优质内容自动点赞，提升互动
4. **深度抓取** - 进入文章详情页获取完整内容
5. **AI评论生成** - 基于文章内容生成个性化评论
6. **数据导出** - 将所有数据保存为结构化CSV文件

**数据输出**:
- `explore_titles.csv` - 文章标题和基础信息
- `scraped_articles.csv` - 详细文章内容和AI评论

**技术特点**:
- 🤖 集成AI评论生成，内容真实自然
- 📊 结构化数据存储，便于分析
- 🔍 智能内容过滤，避免重复操作
- 🛡️ 反爬虫机制规避

### 📚 知识库文档管理 (`test_knowledge_base`)

**功能概述**: 自动化知识库文档创建和管理

**核心流程**:
1. **知识库导航** - 自动进入用户的知识库列表
2. **空间选择** - 智能选择第一个可用的知识库空间
3. **文档创建** - 创建新文档并设置标题
4. **内容编辑** - 添加富文本内容和格式
5. **保存验证** - 确认文档保存成功
6. **状态检查** - 验证文档在知识库中的显示状态

**技术特点**:
- 📝 支持富文本编辑器操作
- 🔗 智能处理知识库权限和访问
- ✅ 多层验证确保操作成功
- 🎨 支持格式化内容创建

### 👥 用户发现与关注 (`test_explore_follow_user`)

**功能概述**: 智能发现并关注优质创作者

**核心流程**:
1. **用户发现** - 从"逛逛"页面识别活跃用户
2. **用户筛选** - 基于内容质量和活跃度筛选
3. **主页访问** - 自动跳转到用户个人主页
4. **价值评估** - 分析用户的创作质量和影响力
5. **关注操作** - 执行关注动作并验证状态
6. **关系管理** - 记录关注关系，避免重复操作

**技术特点**:
- 🎯 智能用户价值评估算法
- 🔄 关注状态实时验证
- 📈 关注关系数据化管理
- 🚫 重复关注自动避免

### 🤖 AI 评论生成系统

**功能概述**: 基于文章内容生成高质量个性化评论

**核心特性**:
- **内容分析**: 深度理解文章主题和观点
- **情感识别**: 识别文章情感倾向，匹配评论风格
- **个性化生成**: 根据用户画像生成符合身份的评论
- **质量控制**: 确保评论的真实性和建设性
- **多样性保证**: 避免评论模式化和重复

**支持的AI服务**:
- SiliconFlow API
- OpenAI GPT系列
- 其他兼容的大语言模型

## 📊 数据管理

### 生成文件说明
- `config.json` - 配置文件，保存ChromeDriver路径等设置
- `cookie.pkl` - 保存的登录Cookie，用于自动登录
- `screenshots/` - 截图文件夹，保存操作过程中的截图
- `explore_titles.csv` - 抓取的文章标题和链接
- `scraped_articles.csv` - 详细的文章内容和AI评论
- `commented_articles.csv` - 已评论文章的记录
- `articles_summary.csv` - 汇总的数据分析报告

### 数据字段说明
- **标题**: 文章标题
- **链接**: 文章详情页URL
- **作者**: 文章作者信息
- **内容**: 文章正文内容
- **AI评论**: 生成的智能评论
- **操作时间**: 执行操作的时间戳

## ⚠️ 注意事项

### 系统要求
- Python 3.7+
- Chrome浏览器（最新版本推荐）
- 对应版本的ChromeDriver
- 稳定的网络连接
- 足够的系统内存（建议4GB+）

### 使用建议
1. **首次使用**: 建议先执行"智能小记"功能，这是最简单的测试
2. **网络环境**: 确保网络连接稳定，避免操作超时
3. **浏览器版本**: 保持Chrome浏览器和ChromeDriver版本匹配
4. **数据备份**: 重要数据请及时备份
5. **合理使用**: 请遵守语雀平台的使用条款，避免过度频繁的操作

### 故障排除

#### 1. ChromeDriver相关问题
```
错误: 'chromedriver' executable needs to be in PATH
```
**解决方案**:
- 检查ChromeDriver路径是否正确设置
- 确认ChromeDriver版本与Chrome浏览器版本匹配
- 尝试重新下载对应版本的ChromeDriver
- 确保ChromeDriver文件具有执行权限（macOS/Linux）

#### 2. 登录失败问题
```
错误: 登录超时或失败
```
**解决方案**:
- 检查网络连接是否稳定
- 清除浏览器缓存和Cookie文件
- 删除项目目录下的`cookie.pkl`文件
- 尝试手动访问语雀网站确认可正常访问
- 检查是否需要验证码或其他安全验证

#### 3. 功能执行失败
```
错误: 元素定位失败或操作超时
```
**解决方案**:
- 查看日志区域的详细错误信息
- 确认登录状态正常
- 检查语雀网站是否有页面结构更新
- 尝试增加等待时间或重新执行
- 确保网络连接稳定

#### 4. 界面问题
```
错误: tkinter相关错误或界面无法启动
```
**解决方案**:
- 安装tkinter支持包
- 使用简化命令行界面：`python simple_gui.py`
- 检查Python版本是否支持tkinter
- 在虚拟环境中重新安装依赖

#### 5. AI评论功能问题
```
错误: API调用失败或评论生成失败
```
**解决方案**:
- 检查API密钥是否正确配置
- 确认API服务是否可用
- 检查网络是否能访问API服务
- 验证API配额是否充足
- 尝试更换其他AI服务提供商

### 性能优化建议

1. **内存管理**: 长时间运行时建议定期重启程序
2. **网络优化**: 使用稳定的网络环境，避免频繁断线
3. **并发控制**: 避免同时运行多个实例
4. **资源清理**: 定期清理截图和日志文件
5. **版本更新**: 保持Chrome和ChromeDriver版本同步更新

## ⚙️ 高级配置

### 自定义选择器

项目使用了智能的 CSS 选择器策略，能够适应语雀页面的动态变化：

```python
# 示例：关注按钮的多重选择器
follow_button_selectors = [
    "//button[contains(@class, 'UserInfo-module_followBtn_') and .//span[text()='关注']]",
    "button[class*='UserInfo-module_followBtn_']",
    "button.ant-btn.ant-btn-primary:has(span:contains('关注'))"
]
```

### 错误处理

- **自动重试机制**: 网络异常时自动重试
- **截图记录**: 关键操作自动截图保存
- **日志记录**: 详细的操作日志和错误信息

## 🛡️ 注意事项

1. **账号安全**: 请确保您的语雀账号已完成实名认证
2. **使用频率**: 建议合理控制自动化操作的频率，避免触发反爬机制
3. **数据备份**: 重要数据请及时备份
4. **版本兼容**: 定期更新 ChromeDriver 以保持兼容性

## 🤝 贡献指南

我们欢迎所有形式的贡献！

1. Fork 本项目
2. 创建您的特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交您的更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开一个 Pull Request

## 📝 更新日志

### v1.0.0 (2024-12-19)
- ✨ 初始版本发布
- 🔐 实现智能登录管理
- 📝 完成小记自动化功能
- 🌟 添加逛逛页面互动功能
- 📚 支持知识库文档管理
- 👥 实现用户关注功能
- 🤖 集成 AI 评论生成

## 📄 许可证

本项目采用 [MIT 许可证](LICENSE)。

## ⚠️ 免责声明

本工具仅供学习和研究使用。使用者应当遵守语雀平台的使用条款和相关法律法规。作者不对使用本工具产生的任何后果承担责任。

## 🙏 致谢

感谢所有为开源社区做出贡献的开发者们！

---

<div align="center">
  <p>如果这个项目对您有帮助，请给我们一个 ⭐️</p>
  <p>Made with ❤️ by <a href="https://github.com/poboll">poboll</a></p>
</div>
